\vspace{-2mm}
\section{Methods}
\label{sec:methods}
\vspace{-2mm}
In this part, we present a simple and efficient method to determine the multiple scales $\mathsf{\textit{B}} = \{b_1, b_2, \ldots, b_k\}, b_i \in [s_{min},s_{max}]$, $\forall i \in [1,k]$, where $[s_{min},s_{max}]$ is the range scale of the hierarchical tree $\mathcal{H}$, constructed from dataset $\mathcal{X}$. The multiple scales $\mathsf{\textit{B}}$, moreover, have to satisfy the condition in Definition~\ref{def:multi_scales_representation}.

%Given a hierarchical tree $\mathcal{H}$, constructed from dataset $\mathcal{X}$, with the range scale $[s_{min},s_{max}]$, the problem is how to choose $\mathsf{\textit{B}} = \{b_1, b_2, \ldots, b_k\}, b_i \in [s_{min},s_{max}]$, $\forall i \in [1,k]$. 
With each cluster $C_i \in \mathcal{H}$, let $(\alpha_{min}^{C_i},\alpha_{max}^{C_i})$ be two scale factors at which the cluster $C$ appears and disappears from the tree $\mathcal{H}$. 
\begin{definition}
\label{def:pairwise_scales} Given a cluster $C_i$ in a hierarchical tree $\mathcal{H}$, with range scale $[s_{min},s_{max}]$, the pairwise $(\alpha_{min}^{C_i},\alpha_{max}^{C_i})$ is defined as:
\begin{equation}
\label{equ:pairwise_scales}
\begin{array}{c}
\alpha_{min}^{C_i}= \min \{w_j | w_j \in [s_{min},s_{max}] \wedge C_i \in \mathfrak{L}(w_j) \} \vspace{1.5mm}\\
\alpha_{max}^{C_i}= \max \{w_j | w_j \in [s_{min},s_{max}] \wedge C_i \in \mathfrak{L}(w_j) \} 

\end{array}
\end{equation}
\end{definition}
Pascal et. al.~\cite{pons2011postprocessing} proposed a method to compute $\mathsf{\textit{B}}$ from pairwise $(\alpha_{min}^C,\alpha_{max}^C)$. It is considered that the good clusters would be presented for a wide range of scale factors. Thus, the goodness of a cluster could be measured as $\alpha_{min}^C - \alpha_{max}^C)$ and the best scale representing $C_i$ as $\alpha = \frac{\alpha_{max}^C-\alpha_{min}^C}{2}$.
\begin{definition}
\label{def:goodness_cluster} The \textbf{goodness function $R(C)$ of a cluster $C$} at a scale $w$ is:
\begin{equation}
\label{equ:goodness_cluster}
R_{w}(C) = \frac{\alpha_{max}^C-\alpha_{min}^C}{2} + \frac{2(\alpha_{max}^C- w)(w - \alpha_{min}^C)}{\alpha_{max}^C-\alpha_{min}^C}
\end{equation}
\end{definition}
\begin{definition}
\label{def:goodness_scale} Given a scale $w \in [s_{min},s_{max}]$, the \textbf{goodness fucntion $R(C)$ of a scale $w$} is:
\begin{equation}
\label{equ:goodness_scale}
R(w) = \frac{1}{N}\sum_{C \in \mathfrak{L}(w)} |C|R_{w}(C)
\end{equation}
\end{definition}
A plot line of the $R(w)$ function can be found in the Figure~\ref{fig:goodness_score}. Obviously, $R(w)$ is a quadratic function of $w$, and can be used for determining the scale factors corresponding to the good clusters. By focussing on the local maxima of $R(w)$, we can estimate good scales for representing the tree $\mathcal{H}$, and thus getting the $\mathsf{\textit{B}} = \{b_1, b_2, \ldots, b_k\}, b_i \in [s_{min},s_{max}], \forall i \in [1,k]$. In another way, the first derivative of $R(w)$ is set to zero, and we arrive a set of multiple scales $\mathsf{\textit{B}}$.
\begin{equation}
\label{equ:derivation_R}
\mathsf{\textit{B}} = \{b_i \vert b_i \in [s_{min},s_{max}]  \wedge R'(b_i) = 0\}
\end{equation}

The most difficult task is to compute the pairwise $(\alpha_{min}^{C_i},\alpha_{max}^{C_i})$ for each cluster $C_i \in \mathcal{H}$. Pascal et. al in ~\cite{pons2011postprocessing} proposed a method to calculate $(\alpha_{min}^C,\alpha_{max}^C)$ based on the concept of \emph{relevant community}. However, the proposed procedure is computational cost, and the complexity is between $O(n\log n)$ and $O(n^2)$ with an average value in $O(n \sqrt{n})$. As the meanwhile, the hierarchical order of the tree $\mathcal{H}$ provides a good hint about the scales where each cluster appears or disappears. By exploring this information, we suggest a more easy and efficient way with the complexity $O(1)$: $\alpha_{min}^{C_i} = s(C_i)$ and $\alpha_{max}^{C_i} = s(parent(C_i))$, where $s(C_k)$ is the level of detail of cluster $C_k$. Obviously, the suggested computing $(\alpha_{min}^{C_i},\alpha_{max}^{C_i})$ is intuitively, as the Definition~\ref{def:level_detail}. %of the level of detail in
